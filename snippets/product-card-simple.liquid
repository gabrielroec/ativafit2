{%- if product != blank -%}
  {%- assign variant = product.selected_or_first_available_variant -%}
  <div class="product-card-simple__card">
    <a
      class="product-card-simple__link"
      href="{{ product.url }}"
      aria-label="{{ product.title | escape }}">
      <div class="product-card-simple__image">
        {%- if product.featured_image -%}
          {{
            product.featured_image | image_url: width: 800 | image_tag: loading: 'lazy', widths: '200, 300, 400, 600, 800', sizes: '(min-width: 990px) 30vw, (min-width: 750px) 45vw, 50vw', alt: product.featured_image.alt | default: product.title | escape
          }}
        {%- else -%}
          {{ 'product-1' | placeholder_svg_tag: 'product-card-simple__placeholder' }}
        {%- endif -%}
      </div>
    </a>

    <div class="product-card-simple__content">
      <h3 class="product-card-simple__title">
        <a href="{{ product.url }}">{{ product.title | escape }}</a>
      </h3>

      {%- assign price = product.price -%}
      {%- assign compare_price = product.compare_at_price_max -%}
      <div class="product-card-simple__price">
        <span class="product-card-simple__price-current">{{ price | money }}</span>
        {%- if compare_price > price -%}
          <span class="product-card-simple__price-compare">{{ compare_price | money }}</span>
        {%- endif -%}
      </div>

      {%- assign rating_metafield = product.metafields.reviews.rating -%}
      {%- assign rating_obj = rating_metafield.value | default: rating_metafield -%}
      {%- assign rating_count = product.metafields.reviews.rating_count.value | default: product.metafields.reviews.rating_count -%}
      {%- if rating_obj and rating_count and rating_count > 0 -%}
        {%- assign rating_value = rating_obj.rating | default: 0 | plus: 0 -%}
        <div class="product-card-simple__rating" aria-label="Rating {{ rating_value }} out of 5 with {{ rating_count }} reviews">
          <span class="product-card-simple__stars" aria-hidden="true">
            {%- for i in (1..5) -%}
              <span class="product-card-simple__star{% if i <= rating_value %} product-card-simple__star--active{% endif %}">â˜…</span>
            {%- endfor -%}
          </span>
          <span class="product-card-simple__rating-value">{{ rating_value }}</span>
          <span class="product-card-simple__rating-count">({{ rating_count }})</span>
        </div>
      {%- endif -%}

      {%- if product.available and variant -%}
        {%- form 'product'
          , product
          , class: 'product-card-simple__form' -%}
          <input
            type="hidden"
            name="id"
            value="{{ variant.id }}">
          <button
            type="submit"
            name="add"
            class="product-card-simple__atc"
            aria-label="Add to cart {{ product.title | escape }}">
            ADD TO CART
          </button>
        {%- endform -%}
      {%- else -%}
        <button
          type="button"
          class="product-card-simple__atc product-card-simple__atc--disabled"
          disabled
          aria-label="Sold out">
          Sold out
        </button>
      {%- endif -%}
    </div>
  </div>
{%- endif -%}