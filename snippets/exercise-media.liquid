{%- comment -%}
  Exercise Media Renderer
  Renders either an image or video based on what's available
  
  Accepts:
  - image: Image object
  - video_url: URL string for video
  - alt_text: Alt text for accessibility
  - width: Image width (default: 1280)
  - height: Image height (default: 480)
  - loading: Loading attribute (default: lazy)
  - class_name: Additional CSS classes
{%- endcomment -%}

{%- liquid
  assign image = image | default: blank
  assign video_url = video_url | default: blank
  assign alt_text = alt_text | default: 'Exercise demonstration'
  assign width = width | default: 1280
  assign height = height | default: 480
  assign loading = loading | default: 'lazy'
  assign class_name = class_name | default: ''
-%}

{%- if video_url != blank -%}
  {%- liquid
    assign poster_url = ''
    if image != blank
      assign poster_url = image | image_url: width: width
    endif
  -%}
  <video
    class="exercise-page__video {{ class_name }}"
    width="{{ width }}"
    height="{{ height }}"
    controls
    loop
    muted
    playsinline
    {% if poster_url != blank %}poster="{{ poster_url }}"{% endif %}
    {% if loading == 'eager' %}preload="auto"{% else %}preload="metadata"{% endif %}>
    <source src="{{ video_url }}" type="video/mp4">
    {%- if image != blank -%}
      {{ image | image_url: width: width | image_tag: loading: loading, alt: alt_text, width: width, height: height }}
    {%- endif -%}
    Your browser does not support the video tag.
  </video>
{%- elsif image != blank -%}
  {{ image | image_url: width: width | image_tag: loading: loading, alt: alt_text, class: class_name, width: width, height: height }}
{%- endif -%}
