{%- comment -%} 
    Choose Your Exercise Section
     
    Theme Editor Configuration: 
    1. Add blocks for each tab (each block = one page tab) 
    2. Each block needs: tab_label, pages (multiple pages), default_active 
    3. Configure initial posts count and load more amount 
    4. Enable/disable search and filter
     
    How to add new tabs: 
    - Click "Add block" in Theme Editor 
    - Select "Page Tab" block type 
    - Set tab label and select pages 
    - Mark as default_active if it should be the first active tab 
{%- endcomment -%}

{%- liquid
  assign show_search = section.settings.show_search
  assign show_filter = section.settings.show_filter

  comment Find the default active tab
  endcomment
  assign active_tab_id = blank
  for block in section.blocks
    if block.settings.default_active
      assign active_tab_id = block.id
      break
    endif
  endfor

  comment If no default active, use first block
  endcomment
  if active_tab_id == blank and section.blocks.size > 0
    assign active_tab_id = section.blocks.first.id
  endif
-%}

<section
  data-section-id="{{ section.id }}"
  data-section-type="choose-your-exercise"
  class="choose-your-exercise"
  style="
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
    {% if section.settings.section_bg != blank %}background-color: {{ section.settings.section_bg }};{% endif %}
  ">
  <div class="choose-your-exercise__container">
    {%- if section.settings.title != blank -%}
      <h2 class="choose-your-exercise__title">{{ section.settings.title }}</h2>
    {%- endif -%}

    {%- if section.blocks.size > 0 -%}
      {%- comment -%} Tab Navigation {%- endcomment -%}
      <div class="choose-your-exercise__tabs-wrapper">
        <div
          class="choose-your-exercise__tabs"
          role="tablist"
          aria-label="Exercise topics">
          {%- for block in section.blocks -%}
            {%- assign is_active = false -%}
            {%- if block.id == active_tab_id -%}
              {%- assign is_active = true -%}
            {%- endif -%}

            <button
              class="choose-your-exercise__tab{% if is_active %} choose-your-exercise__tab--active{% endif %}"
              role="tab"
              aria-selected="{% if is_active %}true{% else %}false{% endif %}"
              aria-controls="panel-{{ block.id }}"
              id="tab-{{ block.id }}"
              data-tab-id="{{ block.id }}"
              {{ block.shopify_attributes }}>
              {{ block.settings.tab_label | default: 'Tab' }}
            </button>
          {%- endfor -%}
        </div>
      </div>

      {%- comment -%} Filters and Search {%- endcomment -%}
      <div class="choose-your-exercise__filters">
        {%- if show_filter -%}
          <div class="choose-your-exercise__filter-wrapper">
            <label for="category-filter-{{ section.id }}" class="visually-hidden">Filter by category</label>
            <select
              id="category-filter-{{ section.id }}"
              class="choose-your-exercise__filter-select"
              data-filter="category"
              aria-label="Filter by category">
              <option value="">All categories</option>
            </select>
          </div>
        {%- endif -%}

        {%- if show_search -%}
          <div class="choose-your-exercise__search-wrapper">
            <label for="search-input-{{ section.id }}" class="visually-hidden">Search pages</label>
            <input
              type="text"
              id="search-input-{{ section.id }}"
              class="choose-your-exercise__search-input"
              placeholder="Search exercises"
              data-search="input"
              aria-label="Search exercises">
            <button
              type="button"
              class="choose-your-exercise__search-clear"
              data-search="clear"
              aria-label="Clear search"
              style="display: none;">
              Ã—
            </button>
          </div>
        {%- endif -%}
      </div>

      {%- comment -%} Tab Panels {%- endcomment -%}
      <div class="choose-your-exercise__panels">
        {%- for block in section.blocks -%}
          {%- assign is_active = false -%}
          {%- if block.id == active_tab_id -%}
            {%- assign is_active = true -%}
          {%- endif -%}

          {%- comment -%} Get pages from block settings {%- endcomment -%}
          {%- assign selected_pages = '' -%}
          {%- if block.settings.page_1 != blank -%}
            {%- assign page_obj_1 = pages[block.settings.page_1] -%}
            {%- if page_obj_1 != blank -%}
              {%- if selected_pages == '' -%}
                {%- assign selected_pages = page_obj_1.handle -%}
              {%- else -%}
                {%- assign selected_pages = selected_pages | append: '|' | append: page_obj_1.handle -%}
              {%- endif -%}
            {%- endif -%}
          {%- endif -%}
          {%- if block.settings.page_2 != blank -%}
            {%- assign page_obj_2 = pages[block.settings.page_2] -%}
            {%- if page_obj_2 != blank -%}
              {%- if selected_pages == '' -%}
                {%- assign selected_pages = page_obj_2.handle -%}
              {%- else -%}
                {%- assign selected_pages = selected_pages | append: '|' | append: page_obj_2.handle -%}
              {%- endif -%}
            {%- endif -%}
          {%- endif -%}
          {%- if block.settings.page_3 != blank -%}
            {%- assign page_obj_3 = pages[block.settings.page_3] -%}
            {%- if page_obj_3 != blank -%}
              {%- if selected_pages == '' -%}
                {%- assign selected_pages = page_obj_3.handle -%}
              {%- else -%}
                {%- assign selected_pages = selected_pages | append: '|' | append: page_obj_3.handle -%}
              {%- endif -%}
            {%- endif -%}
          {%- endif -%}
          {%- if block.settings.page_4 != blank -%}
            {%- assign page_obj_4 = pages[block.settings.page_4] -%}
            {%- if page_obj_4 != blank -%}
              {%- if selected_pages == '' -%}
                {%- assign selected_pages = page_obj_4.handle -%}
              {%- else -%}
                {%- assign selected_pages = selected_pages | append: '|' | append: page_obj_4.handle -%}
              {%- endif -%}
            {%- endif -%}
          {%- endif -%}
          {%- if block.settings.page_5 != blank -%}
            {%- assign page_obj_5 = pages[block.settings.page_5] -%}
            {%- if page_obj_5 != blank -%}
              {%- if selected_pages == '' -%}
                {%- assign selected_pages = page_obj_5.handle -%}
              {%- else -%}
                {%- assign selected_pages = selected_pages | append: '|' | append: page_obj_5.handle -%}
              {%- endif -%}
            {%- endif -%}
          {%- endif -%}
          {%- if block.settings.page_6 != blank -%}
            {%- assign page_obj_6 = pages[block.settings.page_6] -%}
            {%- if page_obj_6 != blank -%}
              {%- if selected_pages == '' -%}
                {%- assign selected_pages = page_obj_6.handle -%}
              {%- else -%}
                {%- assign selected_pages = selected_pages | append: '|' | append: page_obj_6.handle -%}
              {%- endif -%}
            {%- endif -%}
          {%- endif -%}
          {%- assign page_handles = selected_pages | split: '|' -%}

          <div
            class="choose-your-exercise__panel{% if is_active %} choose-your-exercise__panel--active{% endif %}"
            role="tabpanel"
            id="panel-{{ block.id }}"
            aria-labelledby="tab-{{ block.id }}"
            data-panel-id="{{ block.id }}"
            {{ block.shopify_attributes }}>
            {%- if page_handles.size > 0 -%}
              {%- comment -%} Section Title (from block settings) {%- endcomment -%}
              <h3 class="choose-your-exercise__panel-title">{{ block.settings.tab_label }}</h3>

              {%- comment -%} Collect all unique tags from pages {%- endcomment -%}
              {%- assign page_tags_string = '' -%}
              {%- for page_handle in page_handles -%}
                {%- assign current_page = pages[page_handle] -%}
                {%- if current_page != blank and current_page.metafields.custom.tag != blank -%}
                  {%- assign tag_lower = current_page.metafields.custom.tag | downcase -%}
                  {%- unless page_tags_string contains tag_lower -%}
                    {%- if page_tags_string == '' -%}
                      {%- assign page_tags_string = current_page.metafields.custom.tag -%}
                    {%- else -%}
                      {%- assign page_tags_string = page_tags_string | append: '|' | append: current_page.metafields.custom.tag -%}
                    {%- endif -%}
                  {%- endunless -%}
                {%- endif -%}
              {%- endfor -%}
              {%- assign page_tags = page_tags_string | split: '|' -%}

              {%- comment -%} Pages Grid {%- endcomment -%}
              <div class="choose-your-exercise__grid" data-pages-container>
                {%- for page_handle in page_handles -%}
                  {%- assign current_page = pages[page_handle] -%}
                  {%- if current_page != blank -%}
                    <div
                      class="choose-your-exercise__page-item"
                      data-page-id="{{ current_page.id }}"
                      data-page-title="{{ current_page.title | downcase | escape }}"
                      data-page-excerpt="{{ current_page.content | default: '' | strip_html | downcase | escape }}"
                      data-page-tag="{% if current_page.metafields.custom.tag != blank %}{{ current_page.metafields.custom.tag | downcase | escape }}{% endif %}">
                      {%- render 'page-card'
                        ,
 page: current_page
                        ,
 show_tag: true
                        ,
 show_read_time: true
                        ,
 image_aspect: 'card'
                        ,
 classes: 'choose-your-exercise__card'
                      -%}
                    </div>
                  {%- endif -%}
                {%- endfor -%}
              </div>

              {%- comment -%} Empty State (hidden by default, shown via JS when filtered) {%- endcomment -%}
              <div class="choose-your-exercise__empty" style="display: none;">
                <p class="choose-your-exercise__empty-text">No exercises found</p>
              </div>

              {%- comment -%} Store tags in data attribute for JS {%- endcomment -%}
              <script type="application/json" data-page-tags>
                [
                  {%- for tag in page_tags -%}
                    "{{ tag | escape }}"{% unless forloop.last %},{% endunless %}
                  {%- endfor -%}
                ]
              </script>
            {%- else -%}
              {%- comment -%} Empty state when no pages are selected {%- endcomment -%}
              <div class="choose-your-exercise__empty">
                <p class="choose-your-exercise__empty-text">No exercises found</p>
              </div>
            {%- endif -%}
          </div>
        {%- endfor -%}
      </div>
    {%- else -%}
      {%- comment -%} Empty state when no blocks {%- endcomment -%}
      <div class="choose-your-exercise__empty">
        <p class="choose-your-exercise__empty-text">Please add page tabs in the section settings.</p>
      </div>
    {%- endif -%}
  </div>
</section>

<style>
  /* Choose Your Exercise Section */
  .choose-your-exercise {
    width: 100%;
  }

  .choose-your-exercise__container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .choose-your-exercise__title {
    font-size: 42px;
    font-weight: 700;
    text-align: center;
    margin: 0 0 40px;
    background: linear-gradient(135deg, #eb701f 0%, #d65a0f 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Tabs Navigation */
  .choose-your-exercise__tabs-wrapper {
    margin-bottom: 30px;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .choose-your-exercise__tabs-wrapper::-webkit-scrollbar {
    display: none;
  }

  .choose-your-exercise__tabs {
    display: flex;
    gap: 0;
    border-bottom: 2px solid #e5e5e5;
    min-width: fit-content;
  }

  .choose-your-exercise__tab {
    padding: 16px 24px;
    border: none;
    background: transparent;
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #666;
    cursor: pointer;
    position: relative;
    white-space: nowrap;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border-bottom: 3px solid transparent;
    margin-bottom: -2px;
    border-radius: 8px 8px 0 0;
  }

  .choose-your-exercise__tab:hover {
    color: #eb701f;
    background: linear-gradient(135deg, rgba(235, 112, 31, 0.03) 0%, rgba(235, 112, 31, 0.06) 100%);
    transform: translateY(-2px);
  }

  .choose-your-exercise__tab--active {
    color: #eb701f;
    border-bottom-color: #eb701f;
    background: linear-gradient(135deg, rgba(235, 112, 31, 0.05) 0%, rgba(235, 112, 31, 0.1) 100%);
  }

  .choose-your-exercise__tab:focus {
    outline: 2px solid #333;
    outline-offset: 2px;
  }

  /* Filters and Search */
  .choose-your-exercise__filters {
    display: flex;
    gap: 16px;
    margin-bottom: 40px;
    flex-wrap: wrap;
  }

  .choose-your-exercise__filter-wrapper {
    flex: 0 0 auto;
  }

  .choose-your-exercise__filter-select {
    padding: 12px 16px;
    border: 2px solid #e5e5e5;
    border-radius: 12px;
    font-size: 14px;
    background: #fff;
    cursor: pointer;
    min-width: 180px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  }

  .choose-your-exercise__filter-select:focus {
    outline: none;
    border-color: #eb701f;
    box-shadow: 0 0 0 3px rgba(235, 112, 31, 0.1), 0 4px 12px rgba(0, 0, 0, 0.08);
    transform: translateY(-1px);
  }

  .choose-your-exercise__filter-select:hover {
    border-color: #eb701f;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .choose-your-exercise__search-wrapper {
    flex: 1;
    min-width: 200px;
    position: relative;
    display: flex;
    align-items: center;
  }

  .choose-your-exercise__search-input {
    width: 100%;
    padding: 12px 40px 12px 16px;
    border: 2px solid #e5e5e5;
    border-radius: 12px;
    font-size: 14px;
    background: #fff;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  }

  .choose-your-exercise__search-input:focus {
    outline: none;
    border-color: #eb701f;
    box-shadow: 0 0 0 3px rgba(235, 112, 31, 0.1), 0 4px 12px rgba(0, 0, 0, 0.08);
    transform: translateY(-1px);
  }

  .choose-your-exercise__search-input:hover {
    border-color: #eb701f;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .choose-your-exercise__search-clear {
    position: absolute;
    right: 12px;
    background: none;
    border: none;
    font-size: 24px;
    line-height: 1;
    color: #999;
    cursor: pointer;
    padding: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: color 0.3s ease;
  }

  .choose-your-exercise__search-clear:hover {
    color: #eb701f;
    transform: scale(1.1);
  }

  .choose-your-exercise__search-clear:focus {
    outline: 2px solid #333;
    outline-offset: 2px;
    border-radius: 2px;
  }

  /* Tab Panels */
  .choose-your-exercise__panels {
    position: relative;
  }

  .choose-your-exercise__panel {
    display: none;
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .choose-your-exercise__panel--active {
    display: block;
    opacity: 1;
    transform: translateY(0);
    animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .choose-your-exercise__panel-title {
    font-size: 32px;
    font-weight: 700;
    margin: 0 0 30px;
    color: #333;
    position: relative;
    padding-left: 20px;
  }

  .choose-your-exercise__panel-title::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 6px;
    height: 40px;
    background: linear-gradient(135deg, #eb701f 0%, #d65a0f 100%);
    border-radius: 3px;
  }

  /* Pages Grid */
  .choose-your-exercise__grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 30px;
    margin-bottom: 40px;
  }

  .choose-your-exercise__page-item {
    opacity: 1;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    transform: translateY(0);
  }

  .choose-your-exercise__page-item:hover {
    transform: translateY(-4px);
  }

  .choose-your-exercise__page-item--filtered {
    display: none;
  }

  .choose-your-exercise__card {
    height: 100%;
  }

  /* Empty State */
  .choose-your-exercise__empty {
    text-align: center;
    padding: 60px 20px;
  }

  .choose-your-exercise__empty-text {
    font-size: 16px;
    color: #666;
  }

  /* Visually Hidden */
  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  /* Responsive - Tablet */
  @media screen and (min-width: 768px) {
    .choose-your-exercise__grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .choose-your-exercise__filters {
      flex-wrap: nowrap;
    }

    .choose-your-exercise__search-wrapper {
      flex: 1;
    }
  }

  /* Responsive - Desktop */
  @media screen and (min-width: 1024px) {
    .choose-your-exercise__title {
      font-size: 48px;
      margin-bottom: 50px;
    }

    .choose-your-exercise__grid {
      grid-template-columns: repeat(3, 1fr);
    }

    .choose-your-exercise__panel-title {
      font-size: 36px;
    }
  }

  /* Animations */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateX(-20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Loading Animation for Grid */
  .choose-your-exercise__grid .choose-your-exercise__page-item {
    animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) both;
  }

  .choose-your-exercise__grid .choose-your-exercise__page-item:nth-child(1) { animation-delay: 0.1s; }
  .choose-your-exercise__grid .choose-your-exercise__page-item:nth-child(2) { animation-delay: 0.2s; }
  .choose-your-exercise__grid .choose-your-exercise__page-item:nth-child(3) { animation-delay: 0.3s; }
  .choose-your-exercise__grid .choose-your-exercise__page-item:nth-child(4) { animation-delay: 0.4s; }
  .choose-your-exercise__grid .choose-your-exercise__page-item:nth-child(5) { animation-delay: 0.5s; }
  .choose-your-exercise__grid .choose-your-exercise__page-item:nth-child(6) { animation-delay: 0.6s; }
</style>

<script>
  (function() {
    'use strict';
    
    class ChooseYourExercise {
      constructor(section) {
        this.section = section;
        this.tabs = section.querySelectorAll('[role="tab"]');
        this.panels = section.querySelectorAll('[role="tabpanel"]');
        this.searchInput = section.querySelector('[data-search="input"]');
        this.searchClear = section.querySelector('[data-search="clear"]');
        this.filterSelect = section.querySelector('[data-filter="category"]');
        this.activePanel = null;
        this.searchTimeout = null;
        
        this.init();
      }
      
      init() {
        // Tab switching
        this.tabs.forEach(tab => {
          tab.addEventListener('click', (e) => this.handleTabClick(e));
        });
        
        // Search with debounce
        if (this.searchInput) {
          this.searchInput.addEventListener('input', (e) => this.handleSearch(e));
        }
        
        if (this.searchClear) {
          this.searchClear.addEventListener('click', () => this.clearSearch());
        }
        
        // Filter select
        if (this.filterSelect) {
          this.filterSelect.addEventListener('change', (e) => this.handleFilter(e));
        }
        
        // Initialize active panel
        this.setActivePanel(this.section.querySelector('[role="tabpanel"].choose-your-exercise__panel--active'));
      }
      
      handleTabClick(e) {
        const tab = e.currentTarget;
        const panelId = tab.getAttribute('aria-controls');
        const panel = this.section.querySelector(`#${panelId}`);
        
        if (!panel) return;
        
        // Update tabs
        this.tabs.forEach(t => {
          t.classList.remove('choose-your-exercise__tab--active');
          t.setAttribute('aria-selected', 'false');
        });
        tab.classList.add('choose-your-exercise__tab--active');
        tab.setAttribute('aria-selected', 'true');
        
        // Update panels
        this.panels.forEach(p => {
          p.classList.remove('choose-your-exercise__panel--active');
        });
        panel.classList.add('choose-your-exercise__panel--active');
        
        // Set active panel
        this.setActivePanel(panel);
        
        // Reset filters
        this.resetFilters();
      }
      
      setActivePanel(panel) {
        this.activePanel = panel;
        
        if (!panel) return;
        
        // Populate filter select with tags from active panel
        if (this.filterSelect) {
          const tagsData = panel.querySelector('[data-page-tags]');
          if (tagsData) {
            try {
              const tags = JSON.parse(tagsData.textContent);
              this.populateFilterSelect(tags);
            } catch (e) {
              console.error('Error parsing tags:', e);
            }
          } else {
            this.filterSelect.innerHTML = '<option value="">All categories</option>';
          }
        }
        
      }
      
      populateFilterSelect(tags) {
        if (!this.filterSelect) return;
        
        this.filterSelect.innerHTML = '<option value="">All categories</option>';
        
        tags.forEach(tag => {
          const option = document.createElement('option');
          option.value = tag.toLowerCase();
          option.textContent = tag;
          this.filterSelect.appendChild(option);
        });
      }
      
      handleSearch(e) {
        clearTimeout(this.searchTimeout);
        
        this.searchTimeout = setTimeout(() => {
          const query = e.target.value.toLowerCase().trim();
          this.filterPages(query, this.filterSelect?.value || '');
          
          // Show/hide clear button
          if (this.searchClear) {
            this.searchClear.style.display = query ? 'flex' : 'none';
          }
        }, 300);
      }
      
      handleFilter(e) {
        const category = e.target.value;
        const searchQuery = this.searchInput?.value.toLowerCase().trim() || '';
        this.filterPages(searchQuery, category);
      }
      
      filterPages(searchQuery, category) {
        if (!this.activePanel) return;
        
        const pages = this.activePanel.querySelectorAll('[data-page-id]');
        const emptyState = this.activePanel.querySelector('.choose-your-exercise__empty');
        let visibleCount = 0;
        
        pages.forEach(page => {
          const title = page.getAttribute('data-page-title') || '';
          const excerpt = page.getAttribute('data-page-excerpt') || '';
          const tag = page.getAttribute('data-page-tag') || '';
          
          const matchesSearch = !searchQuery || 
            title.includes(searchQuery) || 
            excerpt.includes(searchQuery);
          
          const matchesCategory = !category || 
            tag === category;
          
          if (matchesSearch && matchesCategory) {
            page.classList.remove('choose-your-exercise__page-item--filtered');
            page.style.display = '';
            visibleCount++;
          } else {
            page.classList.add('choose-your-exercise__page-item--filtered');
            page.style.display = 'none';
          }
        });
        
        // Show/hide empty state
        if (emptyState) {
          emptyState.style.display = visibleCount === 0 ? 'block' : 'none';
        }
      }
      
      clearSearch() {
        if (this.searchInput) {
          this.searchInput.value = '';
          this.searchInput.dispatchEvent(new Event('input'));
        }
        if (this.searchClear) {
          this.searchClear.style.display = 'none';
        }
      }
      
      resetFilters() {
        if (this.searchInput) {
          this.searchInput.value = '';
        }
        if (this.searchClear) {
          this.searchClear.style.display = 'none';
        }
        if (this.filterSelect) {
          this.filterSelect.value = '';
        }
        
        // Show all pages in active panel
        if (this.activePanel) {
          const pages = this.activePanel.querySelectorAll('[data-page-id]');
          pages.forEach(page => {
            page.classList.remove('choose-your-exercise__page-item--filtered');
            page.style.display = '';
          });
          
          const emptyState = this.activePanel.querySelector('.choose-your-exercise__empty');
          if (emptyState && pages.length > 0) {
            emptyState.style.display = 'none';
          }
        }
      }
    }
    
    // Initialize when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      const sections = document.querySelectorAll('[data-section-type="choose-your-exercise"]');
      sections.forEach(section => {
        new ChooseYourExercise(section);
      });
    });
    
    // Reinitialize when section is loaded in theme editor
    document.addEventListener('shopify:section:load', (event) => {
      const section = event.target.querySelector('[data-section-type="choose-your-exercise"]');
      if (section) {
        new ChooseYourExercise(section);
      }
    });
  })();
</script>

{% schema %}
  {
    "name": "Choose Your Exercise",
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Section Title",
        "default": "Choose your exercise"
      },
      {
        "type": "header",
        "content": "Filters"
      }, {
        "type": "checkbox",
        "id": "show_search",
        "label": "Show Search",
        "default": true
      }, {
        "type": "checkbox",
        "id": "show_filter",
        "label": "Show Category Filter",
        "default": true
      }, {
        "type": "header",
        "content": "Spacing"
      }, {
        "type": "range",
        "id": "padding_top",
        "label": "Top Padding",
        "min": 0,
        "max": 120,
        "step": 10,
        "default": 60,
        "unit": "px"
      }, {
        "type": "range",
        "id": "padding_bottom",
        "label": "Bottom Padding",
        "min": 0,
        "max": 120,
        "step": 10,
        "default": 60,
        "unit": "px"
      }, {
        "type": "header",
        "content": "Colors"
      }, {
        "type": "color",
        "id": "section_bg",
        "label": "Section Background",
        "info": "Leave empty to use default color"
      }
    ],
    "blocks": [
      {
        "type": "page_tab",
        "name": "Page Tab",
        "settings": [
          {
            "type": "text",
            "id": "tab_label",
            "label": "Tab Label",
            "default": "Tab"
          }, {
            "type": "page",
            "id": "page_1",
            "label": "Page 1",
            "info": "Select the first page for this tab"
          }, {
            "type": "page",
            "id": "page_2",
            "label": "Page 2",
            "info": "Select the second page for this tab"
          }, {
            "type": "page",
            "id": "page_3",
            "label": "Page 3",
            "info": "Select the third page for this tab"
          }, {
            "type": "page",
            "id": "page_4",
            "label": "Page 4",
            "info": "Select the fourth page for this tab"
          }, {
            "type": "page",
            "id": "page_5",
            "label": "Page 5",
            "info": "Select the fifth page for this tab"
          }, {
            "type": "page",
            "id": "page_6",
            "label": "Page 6",
            "info": "Select the sixth page for this tab"
          }, {
            "type": "checkbox",
            "id": "default_active",
            "label": "Set as Default Active Tab",
            "default": false,
            "info": "Only one tab should be marked as active"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Choose Your Exercise",
        "blocks": [
          {
            "type": "page_tab",
            "settings": {
              "tab_label": "Starter",
              "default_active": true
            }
          },
          {
            "type": "page_tab",
            "settings": {
              "tab_label": "Set Up"
            }
          },
          {
            "type": "page_tab",
            "settings": {
              "tab_label": "AtivaPro"
            }
          }
        ]
      }
    ]
  }
{% endschema %}

