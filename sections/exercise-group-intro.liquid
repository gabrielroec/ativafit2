{%- comment -%} 
                                                Exercise Group Introduction Section
                                                Displays title and description for exercise group pages
                                                Optional background video (mp4, muted, loop) with dark-to-white gradient 
{%- endcomment -%}

{%- liquid
  assign section_title = section.settings.title
  assign section_description = section.settings.description
  assign bg_video = section.settings.background_video
  assign mirror_video = section.settings.mirror_video
-%}

{%- if bg_video != blank -%}
  {%- assign bg_video_source = bg_video.sources | first -%}
{%- endif -%}

{%- if bg_video_source != blank -%}
  <link
    rel="preload"
    as="video"
    href="{{ bg_video_source.url }}"
    {% if bg_video_source.mime_type != blank %}
    type="{{ bg_video_source.mime_type }}"
    {% endif %}>
{%- endif -%}

<section
  class="exercise-group-intro{% if bg_video != blank %} exercise-group-intro--has-video{% endif %}{% if mirror_video %} exercise-group-intro--mirror-video{% endif %}"
  data-section-id="{{ section.id }}"
  data-section-type="exercise-group-intro">

  {%- if bg_video != blank -%}
    <div class="exercise-group-intro__video-wrap" aria-hidden="true">
      {{ bg_video | video_tag: autoplay: true, loop: true, muted: true, playsinline: true, controls: false, preload: 'auto', class: 'exercise-group-intro__video' }}
    </div>
    <div class="exercise-group-intro__gradient" aria-hidden="true"></div>
  {%- endif -%}

  <div class="exercise-group-intro__container">
    {%- if section_title != blank -%}
      <h1 class="exercise-group-intro__title">{{ section_title }}</h1>
    {%- endif -%}

    {%- if section_description != blank -%}
      <div class="exercise-group-intro__description">
        {{ section_description }}
      </div>
    {%- endif -%}

    {%- capture badges_markup -%}
      {%- for block in section.blocks -%}
        {%- if block.type == 'muscle_badge' -%}
          {%- assign badge_label = block.settings.muscle_group -%}
          {%- case block.settings.muscle_group -%}
            {%- when 'glutes' -%}{%- assign badge_label = 'Glutes' -%}
            {%- when 'quads' -%}{%- assign badge_label = 'Quads' -%}
            {%- when 'hamstrings' -%}{%- assign badge_label = 'Hamstrings' -%}
            {%- when 'abs' -%}{%- assign badge_label = 'Abs' -%}
            {%- when 'chest' -%}{%- assign badge_label = 'Chest' -%}
            {%- when 'back' -%}{%- assign badge_label = 'Back' -%}
            {%- when 'shoulders' -%}{%- assign badge_label = 'Shoulders' -%}
            {%- when 'biceps' -%}{%- assign badge_label = 'Biceps' -%}
            {%- when 'triceps' -%}{%- assign badge_label = 'Triceps' -%}
            {%- when 'calves' -%}{%- assign badge_label = 'Calves' -%}
            {%- when 'core' -%}{%- assign badge_label = 'Core' -%}
            {%- when 'full_body' -%}{%- assign badge_label = 'Full Body' -%}
          {%- endcase -%}
          <span class="exercise-group-intro__badge" {{ block.shopify_attributes }}>{{ badge_label }}</span>
        {%- endif -%}
      {%- endfor -%}
    {%- endcapture -%}
    {%- assign badges_markup_clean = badges_markup | strip -%}
    {%- if badges_markup_clean != blank -%}
      <div class="exercise-group-intro__badges">
        {{ badges_markup }}
      </div>
    {%- endif -%}
  </div>

</section>

<style>
  .exercise-group-intro {
    position: relative;
    padding: 80px 20px 72px;
    max-width: 1000px;
    margin: 0 auto;
    min-height: 320px;
  }

  .exercise-group-intro--has-video {
    min-height: 620px;
    padding: 280px 20px;
    max-width: none;
    margin: 0;
    overflow: hidden;
  }

  .exercise-group-intro__video-wrap {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .exercise-group-intro__video {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    pointer-events: none;
  }

  .exercise-group-intro--mirror-video .exercise-group-intro__video {
    transform: scaleX(-1);
  }

  .exercise-group-intro__gradient {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 100%;
    z-index: 1;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.85) 0%, rgba(0, 0, 0, 0.55) 45%, #ffffff 100%);
    pointer-events: none;
  }

  .exercise-group-intro--has-video .exercise-group-intro__container {
    position: relative;
    z-index: 2;
    max-width: 1000px;
    margin: 0 auto;
  }

  .exercise-group-intro__container {
    text-align: left;
  }

  .exercise-group-intro__title {
    font-size: 3rem;
    font-weight: 800;
    color: #222;
    margin: 0 0 24px;
    line-height: 1.2;
    background: linear-gradient(90deg, #EB701F 0%, #EFC87D 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .exercise-group-intro__description {
    font-size: 1.125rem;
    line-height: 1.7;
    color: #fff;
    max-width: 800px;
  }

  .exercise-group-intro__badges {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-top: 24px;
  }

  .exercise-group-intro__badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px 14px;
    border-radius: 999px;
    background: rgba(0, 0, 0, 0.45);
    border: 1px solid rgba(255, 255, 255, 0.5);
    color: #fff;
    font-size: 0.9rem;
    font-weight: 600;
    letter-spacing: 0.2px;
    text-transform: uppercase;
  }


  @media (max-width: 768px) {
    .exercise-group-intro {
      padding: 48px 20px 40px;
      min-height: 260px;
    }

    .exercise-group-intro--has-video {
      min-height: 460px;
      padding: 400px 20px 80px 40px;
    }

    .exercise-group-intro__title {
      font-size: 2rem;
      margin-bottom: 20px;
    }

    .exercise-group-intro__description {
      font-size: 1rem;
    }

    .exercise-group-intro__badges {
      gap: 10px;
      margin-top: 18px;
    }

    .exercise-group-intro__badge {
      padding: 7px 12px;
      font-size: 0.8rem;
    }

  }
</style>

{% schema %}
  {
    "name": "Exercise Group Intro",
    "tag": "section",
    "class": "section-exercise-group-intro",
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Title",
        "default": "Introduction"
      }, {
        "type": "richtext",
        "id": "description",
        "label": "Description",
        "default": "<p>Add a description for this exercise group here.</p>"
      }, {
        "type": "video",
        "id": "background_video",
        "label": "Background video",
        "info": "MP4 video in loop, muted. Leave empty to disable."
      }, {
        "type": "checkbox",
        "id": "mirror_video",
        "label": "Mirror video",
        "default": false,
        "info": "Flip the background video horizontally."
      }
    ],
    "blocks": [
      {
        "type": "muscle_badge",
        "name": "Muscle badge",
        "settings": [
          {
            "type": "select",
            "id": "muscle_group",
            "label": "Muscle group",
            "default": "glutes",
            "options": [
              {
                "value": "glutes",
                "label": "Glutes"
              },
              {
                "value": "quads",
                "label": "Quads"
              },
              {
                "value": "hamstrings",
                "label": "Hamstrings"
              },
              {
                "value": "abs",
                "label": "Abs"
              }, {
                "value": "chest",
                "label": "Chest"
              }, {
                "value": "back",
                "label": "Back"
              }, {
                "value": "shoulders",
                "label": "Shoulders"
              }, {
                "value": "biceps",
                "label": "Biceps"
              }, {
                "value": "triceps",
                "label": "Triceps"
              }, {
                "value": "calves",
                "label": "Calves"
              }, {
                "value": "core",
                "label": "Core"
              }, {
                "value": "full_body",
                "label": "Full Body"
              }
            ]
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Exercise Group Intro",
        "blocks": [
          {
            "type": "muscle_badge"
          }, {
            "type": "muscle_badge"
          }, {
            "type": "muscle_badge"
          }
        ]
      }
    ]
  }
{% endschema %}